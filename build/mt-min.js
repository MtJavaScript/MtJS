/*!
*  Mt JS is small JavaScript RIA library
*  Licence MIT
*  Author: Mikhail Tatsky - JavaScript Arhitect
*  http://ru.linkedin.com/pub/mikhail-tatsky/4b/69a/804/
*  Connect with me if want to hire
*/
"use strict";var Mt={global:this,version:"0.0.2"};Mt.apply=function(c,b){for(var a in b){c[a]=b[a]}};Mt.applyIf=function(c,b){for(var a in b){if(c[a]===undefined){c[a]=b[a]}}};Mt.namespace=function(){var d=0,a=arguments.length;for(;d<a;d++){var f=arguments[d],g=f.split("."),c=1,b=g.length;Mt.global[g[0]]=Mt.global[g[0]]||{};var e=Mt.global[g[0]];for(;c<b;c++){e[g[c]]=e[g[c]]||{};e=e[g[c]]}}};Mt.ns=Mt.namespace;Mt.typeOf=function(b){if(b===null){return"null"}var a=typeof b;if(a==="undefined"||a==="string"||a==="number"||a==="boolean"){return a}var c=toString.call(b);switch(c){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}if(a==="function"){return"function"}if(a==="object"){return"object"}};Mt.each=function(g,f){var c=g,e=Mt.typeOf(g);switch(e){case"array":var d=0,b=c.length;for(;d<b;d++){f(g[d],d,g)}break;case"object":var h;for(h in g){f(g[h],h,g)}break}};Mt.Collection=function(a){var d=this;d.items=[];d.keys=[];d.map={};d.indexMap={};d.length=0;if(a){if(a.length>0){var c=0,b=a.length;for(;c<b;c++){d.add(c,a[c])}}else{for(var e in a){d.add(e,a[e])}}}};Mt.Collection.prototype={add:function(a,c){var b=this;b.items.push(c);b.keys.push(a);b.map[a]=c;b.indexMap[a]=b.length;b.length++},remove:function(b){var c=this,a=c.indexMap[b];c.items.splice(a,1);c.keys.splice(a,1);delete c.indexMap[a];delete c.map[b];c.length--},removeAll:function(){var a=this;a.items=[];a.keys=[];a.indexMap={};a.map={};a.length=0},get:function(a){var b=this;return b.map[a]},each:function(c){var d=this,b=0,a=d.length;for(;b<a;b++){c(d.keys[b],d.items[b],b,d.length)}}};(function(){var b={};var c=function(e,d){for(var f in d.prototype){if(e.prototype[f]===undefined){e.prototype[f]=d.prototype[f]}}};var a=function(){};a.prototype={items:new Mt.Collection(),add:function(f,h){var j=f.split("."),e=1,d=j.length-1,g=Mt.global[j[0]];Mt.ns(f);for(;e<d;e++){g=g[j[e]]}if(j.length>1){g[j[j.length-1]]=h}else{Mt.global[j[0]]=h}this.items.add(f,h)},get:function(d){return this.items.get(d)}};Mt.ClassManager=new a();Mt.Class=function(f,e){var e=e||{};if(e.constructor===Object){if(e.extend===undefined){e.constructor=function(){}}else{e.constructor=function(){this.Super("constructor",arguments)}}}if(e.extend===undefined){b[f]=e.constructor}else{b[f]=e.constructor;var d;switch(typeof e.extend){case"string":d=Mt.ClassManager.get(e.extend);b[f].prototype.$Super=Mt.ClassManager.get(e.extend);break;case"function":d=e.extend;b[f].prototype.$Super=e.extend;break}delete e.extend;b[f].prototype.Super=function(j,h){var i=this;if(i.$Iam){i.$Iam=Mt.ClassManager.get(i.$Iam.prototype.$Super.prototype.$name)}else{i.$Iam=Mt.ClassManager.get(i.$Super.prototype.$name)}switch(j){case"constructor":i.$Iam.apply(i,h);break;default:i.$Iam.prototype[j].apply(i,h)}delete i.$Iam};c(b[f],d)}b[f].prototype.$name=f;for(var g in e){b[f].prototype[g]=e[g]}Mt.ClassManager.add(f,b[f])}})();Mt.Class("Mt.Observable",{constructor:function(){var f=this;console.log("Mt.Observable");f.events={};if(f.listeners){var g=f.listeners,d=0,b=g.length;for(;d<b;d++){var k=g[d],e=null,h=null,j=null,c=[];for(var a in k){if(a==="scope"){j=k[a]}else{if(a==="params"){c=k[a]}else{e=a;h=k[a]}}}if(e===null||Mt.isFunction(h)===false){throw new Error("Event was not set")}if(Mt.isArray(c)===false){throw new Error("params must be array")}f.addEvent(e);f.on(e,h,j,c)}}},addEvent:function(a){var b=this;b.events[a]=b.events[a]||[]},addEvents:function(b){var e=this;if(arguments.length>1){var a=[],c=0,d=arguments.length;for(;c<d;c++){a[c]=arguments[c]}b=a}if(Mt.typeOf(b)==="string"){e.events[b]=e.events[b]||[]}else{if(Mt.typeOf(b)==="array"){var c=0,d=b.length;for(;c<d;c++){e.events[b[c]]=e.events[b[c]]||[]}}}},fireEvent:function(b){var g=this,h=g.events[b];if(!h){return false}var e=1,f=arguments.length,d=[g];for(;e<f;e++){d.push(arguments[e])}var e=0,f=h.length;for(;e<f;e++){var c=h[e],a=[];a=a.concat(d);if(c.params){a=a.concat(c.params)}c.fn.apply(c.scope||g,a)}},on:function(a,c,b,e,d){this.events[a].push({fn:c,scope:b,params:e||[],originalFn:d||false})},un:function(a,d){var f=this,g=f.events[a];if(!g){return false}var c=0,e=g.length;for(;c<e;c++){var b=g[c];if(b.originalFn!==false&&b.originalFn===d){g.splice(c,1);return true}else{if(b.fn===d){g.splice(c,1);return true}}}return false},unAll:function(){this.events={}},unAllByType:function(a){this.events[a]=[]},once:function(a,c,b){var e=this,d=function(){c.apply(this,arguments);setTimeout(function(){e.un(a,c)})};e.on(a,d,b,[],c)},has:function(a){var b=this.events[a];if(!b){return false}return b.length!==0}});